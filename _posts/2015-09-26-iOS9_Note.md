---
layout: post
title: "夏目友人帐"
date: 2018-06-21 13:09:06 
description: "iOS9 变化笔记, 以及工作中常遇到的问题"
tag: iOS
---


这里将介绍下我们治愈系的动漫：夏目友人帐。
     

### 简介

夏目贵志生来拥有强大的灵力，能看到妖怪和神明的存在。因其父母双亡，常年辗转于互相推卸责任的亲戚之间，并受到同龄人的欺负。同时被其能力影响，未曾与任何人深交，造成性格一定程度上的孤僻。本性和善，宽厚，踏实。对于自身的不幸，无论是对人类还是妖怪都未曾抱怨过。被藤原夫妇收养后踏入高中。一次被妖怪追赶打破了一只妖怪“斑”的封印，继而牵涉到其祖母夏目玲子的遗物“友人帐”——一本记录着众多妖怪名字的契约书。对友人帐产生兴趣的“斑”与贵志定下约定，自己守护其一生以替换友人帐的所有权，平日则化身成大头招财猫模样的“猫咪老师”。在“斑”的陪伴、八原妖怪和同学们关心鼓励下，贵志经历了一个个或奇异、悲伤、感怀的怪诞故事，并逐渐学会与人类、妖怪友好相处，谱写出一段充满人性哲思的温馨物语。


### 主要人物

**夏目贵志**
主人公,高中生，7月1日生，15岁，身高167厘米，B型。面容清秀，是个善良温和的少年。
自幼失去父母，被认为累赘辗转生活于亲戚家，被没有血缘关系的藤原夫妇收养。幼年因看得见妖怪，得不到别人理解而饱受欺凌，导致长大后虽待人友善，却依然习惯于隐藏自己真正的想法。受藤原夫妇的关怀感化，在与猫咪老师的相处中逐渐变得能够表达自己。非常珍惜现在的生活。得到外祖母的遗物友人帐后，开始了与猫咪老师一同归还妖怪名字的生活。归还名字时，外祖母夏目玲子的记忆会化为思念传进他的脑里，令他对外祖母有更加多的认识，然而每次归还名字后会消耗大量体力。由于与外祖母有着相似的气息，故经常被妖怪误认为是他外祖母。
纵使身体比较瘦弱，但遗传自外祖母玲子的灵力非常高，不需武器一拳便能击退高级妖怪（一击毙命。详情请见第三部第七集的场静司说过的话），在后来还能有一定几率读取到任一妖怪的记忆。对妖怪抱有感情，即使被认为是弱点也不想改变。对于自己貌似女孩子的外貌有些困扰,所以说话时常会故意使用较有男子气概的语气与用法。在学校的女孩子间很有人气,本人却迟钝到完全没感觉。被妖怪们认为有着“即使没有友人帐也能让妖怪们追随”的魅力。

**斑/猫咪老师**
高级妖怪，被封印在招财猫里，因为夏目不小心弄断封印的绳子而被解放，作为宠物猫和保镖与夏目一起生活着。可是因为多年被封印在招财猫中而被同化了，日常行为作风带有浓重的猫习气。招财猫形态被藤原夫妇分别称为喵吉和喵五郎，被田沼要称为胖太。本名斑（まだら），是个拥有强大妖力的妖怪。
据猫咪老师所称，招财猫的外形是“容器”，因此无妖力或灵力的人可以看见其形。因为拒绝与玲子决斗故名字不在友人帐上。自傲的他成为夏目的保镖后要夏目尊称他“猫咪老师”，但很多时候都被戏弄。本与夏目约定其死后友人帐就归他，然而在与夏目相处中逐渐被感化。爱酗酒且酒品奇差，五音不全。喜欢吃馒头，与夏目表面上无时无刻不在斗嘴，其实非常重视夏目。能够变身成任何自己想要的形象，因为仔细观察的人类只有夏目或者玲子，所以通常是变成像夏目玲子的女高中生样子；也曾变成夏目的样子，但因气质差太多，就连普通人类都会觉得猫老师变成的“夏目”怪怪的。

**夏目玲子**
贵志的祖母，友人帐的制作者，5月15日生，金牛座。
在很年轻的时候就去世了，有着极其强大的灵力。据贵志所说，她是未婚生子生下了贵志的妈妈。玲子因为能看到妖怪而被世间不相信妖怪存在的人称为骗子，被人欺负，但依然我行我素 。虽然嘴上说讨厌人类，但其实内心十分渴望人类的朋友。拥有淡淡忧伤的开朗少女用自己独特的方式温暖了妖怪们的心。
据妖怪们所说实力非常强大，使用球棒战斗，而且懂得使用阵法，击败了许多强悍的妖怪

#### 重要妖怪

**树上的妖怪**

本名不详。夏目小时候遇到的善良的半人形妖怪，也是夏目的第一个妖怪朋友，与夏目有很深的羁绊，生活在路旁的樱花树上。

在夏目小时候的回忆中出现，一次偶然和夏目对视，发现夏目可以看到自己，便经常追逐他，并吓唬他，这让夏目开始逃避她，上学或者放学的路上都绕着那棵树走。和夏目一起玩耍的时光使她忘却了一个人的孤独和悲伤。因为无意识地伤害到夏目内心一直很懊悔。

性格正派活泼，喜欢惩罚坏人。曾经变成小猫走到静坐小夏目身边，被夏目抱在怀里。感动于夏目的温柔，说出“想永远和他在一起”的话。认为人类很丑恶，但是夏目除外。夏目搬走后回到了一个人寂寞生活，时常回想起与夏目一起的时光，夏目也一直思念着她。

第三季第四集，夏目为了找她回到小时候住的地方并且找到那棵树，与夏目再次相见后她飞下樱花树与夏目拥抱，被夏目发现就是当时的小猫，并且被夏目要求互相交换了名字

**重点：**

> 配置info.plist，添加一个Required background modes，Array类型的，然后在Required background modes里面Item 0对应的Value设置为App registers for location updates，这样就解决了iOS9后台定位出现蓝条的问题了。


### UI Testing
Xcode7中苹果引入了一种新的方式在应用中进行测试——UI Testting，UI Testting允许我们找到UI元素与之交互，还能检查属性和状态。UI Testting已经完全集成进了Xcode7的测试报告，可以和单元测试一起执行。使用起来跟之前Xcode5出来的XCTest差不多，Xcode bots提供对此的支持，而且command line支持当UI测试失败时会立即发出通知。

可以参考Github上的Demo，步骤：

1. 在DemoTests.m里创建一个test开头的方法
2. 在setUp()里启动应用 `XCUIApplication().launch()`
3. 新建一个方法test开头的，在里面获取应用`let app = XCUIApplication()`
4. 的到`let app = XCUIApplication()`，a`pp.buttons[“View Detail”].tap()?`。buttons是当前这个界面的所有按钮的集合，[]里面写按钮的名字，tap()就是执行这个按钮所对应的方法，可以是网络请求、界面跳转等等。


### URL scheme

在iOS9中，如果使用URL scheme必须在"Info.plist"中将你要在外部调用的URL scheme列为白名单，否则不能使用。

配置info.plist，添加一个`LSApplicationQueriesSchemes`，Array类型的，然后在`LSApplicationQueriesSchemes`的Item里面添加urlscheme就行了，urlscheme是任意一个字符串，就是你自己需要使用的urlscheme，iOS9 URL scheme白名单适配就完成了。

### 出现大量的警告

Xcode7后运行以前的项目后出现大量的警告如：

```bash
(null): warning: /var/folders/p4/z7zy68r92hd3p5ry5g2v3k_8rlwzzr/C/org.llvm.clang.dalmo/ModuleCache/1TXZDLI9N2EMV/Foundation-3DFYNEBRQSXST.pcm: No such file or directory。
```

作为一个有洁癖的我反正是不能忍，出现警告的大致原因跟我上面提到的开启Bitcode，.dSYM文件不能用来符号化有关，Xcode试图去创建dSYM文件，但是你又不需要。

### 解决方法

1. Build Settings ——>Build Options——>Debug Information Format
2. Debug下的DWARF with dsYM File改成DWARF
3. Release下的还是之前默认的DWARF with dsYM File不变
 

参考资料：

- [iOS9AdaptationTips](https://github.com/ChenYilong/iOS9AdaptationTips) 
- [iOS9学习系列](http://www.cocoachina.com/ios/20150821/13140.html) 
- [iOS9-day-by-day](https://github.com/shinobicontrols/iOS9-day-by-day)



<br>

转载请注明：[潘柏信的博客](http://baixin) » [点击阅读原文](http://baixin.io/2015/09/iOS9_Note/)
